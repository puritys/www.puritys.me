<!DOCTYPE html>
<html>
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M3BFP5');</script>
    <!-- End Google Tag Manager -->

    <link href="http://www.puritys.me/templates/static/css/files?default.less&amp;other.less&amp;ezHTML.less&amp;?v=20180416-2" rel="stylesheet" type="text/css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js?v=20180416-2"></script>
    <script src="http://www.puritys.me/templates/static/js/files?lightHttp-simple-min.js&amp;default.js&amp;facebookAPI.js&amp;form_check.js&amp;util.js&amp;listAutoLoadMore.js&amp;?v=20180416-2"></script>
    <script src="../templates/static/js/files%3Fnone.html" type="text/javascript" charset="utf-8"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="content-language" content="en" />
    <meta name="author" content="Puritys" />
    <title>Google Spider Hacked My Website</title>
    <meta name="keywords" content="" />
    <meta name="description" content=" Google is a strong search engine. You can find a lot of knowledge and information in the search result of google web pages. But have you been hacked by google? Yes, I have.Google spider is " />
    <meta property="fb:app_id" content="160015347378316" />
    <meta property="fb:admins" content="1140660203"/>
    

    <link rel="shortcut icon" href="../templates/static/images/favicon_puritys.ico" /> 
    

    <link rel="canonical" href="article-205.html"/>
    

    <link rel="alternate" hreflang="zh-TW" href="http://www.puritys.me/docs-blog/article-204">
        


    <link rel="amphtml" href="../docs-blog-amp/article-205-Google-Spider-Hacked-My-Website.html"/>
    

    <link rel="dns-prefetch" href="apis.google.com.html">
        <link rel="dns-prefetch" href="ajax.googleapis.com.html">
        <link rel="dns-prefetch" href="connect.facebook.net.html">
        <link rel="dns-prefetch" href="www.google-analytics.com.html">
        <link rel="dns-prefetch" href="www.puritys.me.html">
        

<!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    
<script type="application/ld+json">
{
   "@context": "http://schema.org",
   "@type": "WebSite",
   "url": "//www.puritys.me",
   "potentialAction": {
     "@type": "SearchAction",
     "target": "https://www.puritys.me/search?searchText={search_term_string}",
     "query-input": "required name=search_term_string"
   }
}
    </script>
    


<script type="application/ld+json">
{ "@context" : "http://schema.org",
  "@type" : "Organization",
  "name" : "",
  "url" : "//www.puritys.me",
  "sameAs" : [ 
    
    "https://github.com/puritys",
    
    "https://www.facebook.com/Puritys.Chen.5815"
    
  ] 
}
    </script>







</head>
<body>

            
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M3BFP5"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


            
<div class="settings">
    
        <script>var WRT="https://www.puritys.me/";</script>
    
</div>


            
<div class="header">
    <div class="top-header">
        <div class="main">
        <a class="logo" href="../index.html"><img src="../templates/static/images/logo_puritys.png" alt="Puritys Blog" title="Puritys Blog"></a>
        <a class="navbar-btn" href="article-205-Google-Spider-Hacked-My-Website.html#"><span class="icon"></span></a>
        </div>
        <ul class="navbar">
             
            <li >
                <a href="../news.html" data-ga='{"action":"menu_click","label":"\u7db2\u8def\u65b0\u805e"}'>網路新聞</a>
            </li>
             
            <li >
                <a href="../life.html" data-ga='{"action":"menu_click","label":"\u751f\u6d3b\u65c5\u904a"}'>生活旅遊</a>
            </li>
             
            <li class="active">
                <a href="../WEB_SECURITY.html" data-ga='{"action":"menu_click","label":"\u7db2\u8def\u5b89\u5168"}'>網路安全</a>
            </li>
             
            <li >
                <a href="../docs-cate.html" data-ga='{"action":"menu_click","label":"\u7a0b\u5f0f\u96dc\u8a18"}'>程式雜記</a>
            </li>
            
        </ul>
        <form action="http://www.puritys.me/search" class="navbar-form">
            <input type="text" name="searchText" placeholder="Input your keyword" value="">
            <i class="glyphicon glyphicon-search"></i>
        </form>
    </div>
</div>


        

        
<div class="body-content">
    
            
    <div class="main">
        
                
<ul class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList"> 
    <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
        <a href="../index.html" itemscope itemtype="http://schema.org/Thing" itemprop="item">
            <em><span itemprop="name">Home</span></em>
        </a>
        <meta itemprop="position" content="1" />
    </li>
    
        
            <li  itemprop="itemListElement" itemscope  itemtype="http://schema.org/ListItem">
                <a href="../WEB_SECURITY.html" itemscope itemtype="http://schema.org/Thing" itemprop="item">
                    <em><span itemprop="name">網路安全</span></em>
                </a>
                <meta itemprop="position" content="2" />
            </li>
        
    
        
            <li class="active">
                <a href="http://www.puritys.me/docs-blog/article-205">
                    <em><span>Google Spider Hacked...</span></em>
                </a>
            </li>
        
    
</ul>

        
                


<script type="application/ld+json">
    {"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.puritys.me\/docs-blog\/article-205-Google-Spider-Hacked-My-Website.html"},"headline":"Google Spider Hacked My Website","image":"","datePublished":"2014-01-04T23:58:24+08:00","dateModified":"2016-12-29T12:57:58+08:00","author":{"@type":"Person","name":"puritys"},"publisher":{"@type":"Organization","name":"www.puritys.me","logo":{"@type":"ImageObject","url":"https:\/\/www.puritys.me\/templates\/static\/images\/favicon_puritys.ico"}},"description":" \rGoogle is a strong search engine.  You can find a lot of knowledge and information in the search r"}
</script>


<div class="entry">
   <div class="entry-header">
        
        <div class="date">
            <div class="year">2014</div>
            <div class="month">Jan</div>
            <div class="day">04</div>
        </div>

        
        <div class="title">
            <h1><a href="article-205-Google-Spider-Hacked-My-Website.html"><span>Google Spider Hacked My Website</span></a></h1>
            <div class="sub">
                <div class="caption">Tags:</div>
                <ul class="labels">
                    
                </ul>
            </div>
            
            <div class="lang-wrap">
            
                <a href="http://www.puritys.me/docs-blog/article-204" rel="alternate" hreflang="zh-TW">繁中版</a>
            
            </div>
            
        </div>
    </div>

    
    <div class="entry-body">
        <div class="ezHTML-content"> <br /><p>Google is a strong search engine.  You can find a lot of knowledge and information in the search result of google web pages.  But have you been hacked by google?  Yes,  I have.</p><div class="notice" label="notice">Google spider is still hacking others system every day. I will explain what happen on my website.</div><p>A long time ago,  I was a freelancer. One day, a customer gave me a case that they needed me to create a website for their customer. My customer had a content management system which includes member, news, guestbook and so on.  They asked me to use their system to create a new website.</p><p>It was a simple website, so I just completed the development in about a week. Then I provided a test url of website for my customer. They could upload the information about products to my new content management system.</p><p>The web page was a little like the following table:</p><table class="table" style="width: 80%; margin: 0 auto;"><tr>   <th>Title</th><th>Image</th><th>Content</th><th>Edit</th><th>Delete</th></tr><tr>   <td>First  xx</td><td>xx</td><td>article content??</td><td><a href="article-205-Google-Spider-Hacked-My-Website.html#">Edit</a></td><td><a href="article-205-Google-Spider-Hacked-My-Website.html#">Delete</a></td></tr><tr>   <td>Second xx</td><td>xx</td><td>article content??</td><td><a href="article-205-Google-Spider-Hacked-My-Website.html#">Edit</a></td><td><a href="article-205-Google-Spider-Hacked-My-Website.html#">Delete</a></td></tr><tr>   <td>Third xx</td><td>xx</td><td>article content??</td><td><a href="article-205-Google-Spider-Hacked-My-Website.html#">Edit</a></td><td><a href="article-205-Google-Spider-Hacked-My-Website.html#">Delete</a></td></tr></table><p>My customer&#39;s customer uploaded many articles via this new content management system. But one day, a strange thing happened on this website. All of the articles had disappeared suddenly. The customer called me and asked me what happened to these articles today. At that moment, I had no idea and did not know how to explain this situation. Additionally, they thought my website was hacked by someone, maybe a hacker.</p><p>I started to check the access logs from apache service and found many logs about deleting articles action.  I also noticed some special information, these access logs had the information of browser user agent, and that told me the attacker was "Google Bot". The following are the example of access logs on my website:</p><div class="codeBlock php"><span class="title"> Access Logs</span><pre class="prettyprint lang-php linenums" ><ol class="linenums"><li class="L0"><span class="lit">10.53</span><span class="pun">.</span><span class="pln">xx</span><span class="pun">.</span><span class="pln">x </span><span class="pun">[</span><span class="lit">01</span><span class="pun">/</span><span class="pln">Jan</span><span class="pun">/</span><span class="lit">2008</span><span class="pun">]</span><span class="pln"> </span><span class="str">"GET /admin/delete.php?id=1 HTTP/1.1"</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">39</span><span class="pln"> </span><span class="str">"Google Bot  xxxx"</span></li><li class="L1"><span class="lit">10.53</span><span class="pun">.</span><span class="pln">xx</span><span class="pun">.</span><span class="pln">x </span><span class="pun">[</span><span class="lit">01</span><span class="pun">/</span><span class="pln">Jan</span><span class="pun">/</span><span class="lit">2008</span><span class="pun">]</span><span class="pln"> </span><span class="str">"GET /admin/delete.php?id=2 HTTP/1.1"</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">39</span><span class="pln"> </span><span class="str">"Google Bot  xxxx"</span></li><li class="L2"><span class="lit">10.53</span><span class="pun">.</span><span class="pln">xx</span><span class="pun">.</span><span class="pln">x </span><span class="pun">[</span><span class="lit">01</span><span class="pun">/</span><span class="pln">Jan</span><span class="pun">/</span><span class="lit">2008</span><span class="pun">]</span><span class="pln"> </span><span class="str">"GET /admin/delete.php?id=3 HTTP/1.1"</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">39</span><span class="pln"> </span><span class="str">"Google Bot  xxxx"</span></li></ol></pre></div><p>I tested the function of delete and found these articles really could be deleted by anyone even if he is not an admin of the system. A hacker could skip the login function and directly delete articles.</p><p>The problem is happened in login function of my customer&#39;s system. They never stopped the process from executing when the script tried to redirect the nonlogin member to login page.</p><p>The PHP script of deleting function is like the below codes.</p><div class="codeBlock php"><span class="title"> delete.php content</span><pre class="prettyprint lang-php linenums" ><ol class="linenums"><li class="L0"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">login</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span></li><li class="L1"><span class="pln">   header</span><span class="pun">(</span><span class="str">"location: index.php"</span><span class="pun">);</span></li><li class="L2"><span class="pun">}</span></li><li class="L3"><span class="pln">&nbsp;</span></li><li class="L4"><span class="pln">deleteArticle</span><span class="pun">($</span><span class="pln">id</span><span class="pun">);</span></li></ol></pre></div><p>This program has a big problem. When PHP execute header function.  It will echo the response of HTTP request like the below example, and the program will run next line until the end of line or executing exit.。</p><div class="codeBlock html"><span class="title"> HTTP Response</span><pre class="prettyprint lang-html linenums" ><ol class="linenums"><li class="L0"><span class="pln">HTTP/1.1 302 </span></li><li class="L1"><span class="pln">location index.php</span></li></ol></pre></div><p>That is why Google Spider deleted every article. Because Google Spider scanned all of the articles on a website, and it click all deleting anchor. Unfortunately, Google Spider is still doing it right now.  He is trying to delete every article on any website.</p> <br /></div>
    </div>
    <div class="entry-footer">
        <p class="article-modify-author">This post was last modified by
            <span>puritys</span>
            <time datetime="2016-12-29T12:57:58+08:00" class="article-modify-time">2016/12/29</time>
        </p>

        
    <ul class="share-btn-wrap">
        <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.puritys.me/docs-blog/article-205" class="shareBtn" title="share" rel="nofollow"></a></li>
        <li>
            <iframe src="https://www.facebook.com/plugins/like.php?href=https://www.puritys.me/docs-blog/article-205" scrolling="no" frameborder="0"
                style="border:none; width:450px; height:80px"></iframe>
        </li>
    </ul>



        
    </div>
    
    
        <br />
        <ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-1449650742587459"
     data-ad-slot="2197220184"></ins>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-1449650742587459",
          enable_page_level_ads: true
     });
</script>
    

</div>

        
            
    </div>
    

            
    <div class="sidebar">
        
                

<div class="list-group">                                                                                                                            
    <h4 class="list-group-heading">類別 網路安全</h4>
    <ul>
    
        <li><a href="./article-376-HTTP-:-SSLv3-漏洞---Poodle-攻擊.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_376&quot;}'>HTTP : SSLv3  漏洞  - Poodle 攻擊 </a></li>
    
        <li><a href="article-367-IceCTF-2016-challenges.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_367&quot;}'>IceCTF 2016  challenges </a></li>
    
        <li><a href="article-346-SYN-flood-attack-：封包-DOS-攻擊.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_346&quot;}'>SYN flood attack ：封包 DOS 攻擊 </a></li>
    
        <li><a href="article-276-網路安全相關-Blog.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_276&quot;}'>網路安全相關 Blog </a></li>
    
        <li><a href="article-251-OpenSSL-CVE-2014-0160-Heartbleed-漏洞.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_251&quot;}'>OpenSSL CVE-2014-0160 Heartbleed  漏洞 </a></li>
    
        <li><a href="article-249-Chrome-Extension-MultiLogin-駭客盜帳號%3F.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_249&quot;}'>Chrome Extension MultiLogin 駭客盜帳號? </a></li>
    
        <li><a href="article-236-DNS-HIJACKING-說明與防護.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_236&quot;}'>DNS HIJACKING  說明與防護 </a></li>
    
        <li><a href="article-226-六種常見的駭客攻擊方式.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_226&quot;}'>六種常見的駭客攻擊方式 </a></li>
    
        <li><a href="article-212-網站路徑駭客攻擊.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_212&quot;}'>網站路徑駭客攻擊 </a></li>
    
        <li><a href="article-205-Google-Spider-Hacked-My-Website.html" data-ga='{&quot;action&quot;:&quot;list_click&quot;,&quot;label&quot;:&quot;id_205&quot;}'>Google Spider Hacked My Website </a></li>
    
    </ul>
</div>


        
                


        
            
    </div>
    
        
</div>



    

            
<div class="bottom-footer">
    <ul class="nav">
        
        <li >
            <a href="../news.html">網路新聞</a>
        </li>
        
        <li >
            <a href="../life.html">生活旅遊</a>
        </li>
        
        <li class="active">
            <a href="../WEB_SECURITY.html">網路安全</a>
        </li>
        
        <li >
            <a href="../docs-cate.html">程式雜記</a>
        </li>
        

        <li>
            <a href="https://www.puritys.me/">puritys.me</a>
        </li>
        <li>
            <a href="http://www.lingihuang.com/">VIVIAN CRAP</a>
        </li>
        
    </ul>
    <p>Copyright &amp;copy; 2014 PURITYS.COM. All rights reserved.</p>
</div>


            
<script src="https://connect.facebook.net/en_US/all.js"></script>


        
</body>
    <script src="../templates/static/js/files%3Fsidebar.js&amp;ezHTML_main.js&amp;%3Fv=20180416-2"></script>
</html>